<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div>
    <h1> add todo</h1>
    <form class="form" method="post" action="/todo">
        <input type="text" name="title" placeholder="Title">
        <input type="text" name="description" placeholder="Description">
        <button>Submit</button>
    </div>

    </form>
    <div>
    <h1> delete todo</h1>
    <form class="form" method="delete" action="/todo/{id}" id="deleteForm">
        <input type="text" name="id" id="todoId" placeholder="ID">
        <button>Submit</button>
    </form>
    </div>

    <div>
        <h1> update todo</h1>
        <form class="form" method="post" action="/todo/{id}" id="updateForm">
            <input type="text" name="id" placeholder="ID" id="id">
            <input type="text" name="title" placeholder="Title" id="title">
            <input type="text" name="description" placeholder="Description" id="description">

            <label for="done">Done</label>
            <input type="checkbox" name="done" id="done">
            <button>Submit</button>
        </form>
    </div>
</body>

</html>
<p id="result"></p>

<script>
    document.getElementById("deleteForm").addEventListener("submit", function (event) {
        event.preventDefault(); // stop normal form submit

        const todoId = document.getElementById("todoId").value;

        fetch(`http://localhost:8080/todo/${todoId}`, {
            method: "DELETE"
        })
            .then(response => response.text())
            .then(message => {
                document.getElementById("result").innerText = message;
            });
    });
</script>


<script>
    document.getElementById("updateForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const todoId = document.getElementById("id").value;
        const title = document.getElementById("title").value;
        const description = document.getElementById("description").value;
        const done = document.getElementById("done").checked;

        // build form data for request
        const formData = new URLSearchParams();
        formData.append("title", title);
        formData.append("description", description);
        formData.append("done", done);

        fetch(`http://localhost:8080/todo/${todoId}`, {
            method: "PUT",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: formData.toString()
        })
            .then(response => response.text())

    });
</script>